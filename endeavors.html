<html lang="ru">

<head>
  <style>
    .selected {
      font-weight: bold;
      border: 1px dashed grey;
      border-radius: 4px
    }

    table {
      border-spacing: 17px 3px;
    }
  </style>
</head>

<body>
  <div>
    <div>
      <a href="/">ToDo</a>
    </div>
    <input id=newEnd />
    <input id="deadline" type="date">
    <div><textarea id="detail" cols="30" rows="10"></textarea></div>
    <button id=create>Создать Стремление</button>
  </div>
  Мои Стремления:
  <table>
    <thead>
      <tr>
        <th>Название</th>
        <th>Детали</th>
        <th>Дедлайн</th>
      </tr>
    </thead>
    <tbody id=endvrs>
      <!-- <tr>
        <td>пробежать полуфрафон</td>
        <td>за 120 мин</td>
        <td>2020-09-25</td>
      </tr>
      <tr>
        <td>раскрутить Ютуб канал</td>
        <td>10 000 подписчиков</td>
        <td>2020-06-01</td>
      </tr> -->
    </tbody>
  </table>
  <script>
    fetch(location.origin + "/api/endeavor/get")
      .then(response => response.json()).then(arr =>
        endvrs.innerHTML += arr.reduce((html, doc) =>
          html +`<tr id="${doc._id}">
            <td>${doc.name}</td>
            <td>${doc.details}</td>
            <td>${doc.deadline}</td>
          </tr>`, ""
        )
      )
    create.onclick = function () {
      if (!newEnd.value.trim()) return

      newEnd.value = newEnd.value.trim()
      var promise = fetch(location.origin + "/api/endeavor/add", {
        headers: {
          endeavor: encodeURI(newEnd.value),
          details: encodeURI(detail.value),
          deadline: deadline.value
        }
      })
      promise.then(response => response.text()).then(text => {
        endvrs.innerHTML = endvrs.innerHTML + `<tr id="${text}">
        <td>${newEnd.value}</td>
        <td>${detail.value}</td>
        <td>${deadline.value}</td>
      </tr>`
      })

    }
  </script>
</body>